{
    "blockly": false,
    "blockly_xml": "<xml></xml>",
    "category": "Tech Sessions",
    "coa": {
        "data": {
            "clean": true,
            "code_block": "\n",
            "description": "This playbook processes filehashes not in bogon_list and creates a task note for every indicator for review by the analyst",
            "hash": "9cfa0f79846803a6b6d2f0a947f23cabfb69e8f8",
            "joint": {
                "cells": [
                    {
                        "0": "S",
                        "1": "T",
                        "2": "A",
                        "3": "R",
                        "4": "T",
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "ref-x": 33,
                                "ref-y": 8,
                                "text": "START"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.icon image": {
                                "ref-x": 13,
                                "xlink:href": "/inc/coa/img/block_icon_start.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def on_start(container):\n    phantom.debug('on_start() called')\n    \n    # call 'check_fileHash' block\n    check_fileHash(container=container)\n\n    return",
                        "callback_code": "# read-only block view not available",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "0d75d904-721f-445e-a6e1-b1d349bb4515",
                        "inPorts": [],
                        "join_code": "# read-only block view not available",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 25,
                        "line_start": 17,
                        "name": "",
                        "notes": "",
                        "number": 0,
                        "order": 1,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": -320,
                            "y": -60
                        },
                        "previous_function": "",
                        "previous_name": "",
                        "show_number": true,
                        "size": {
                            "height": 54,
                            "width": 80
                        },
                        "status": "",
                        "title": "START",
                        "type": "coa.StartEnd",
                        "warn": false,
                        "z": 1
                    },
                    {
                        "0": "E",
                        "1": "N",
                        "2": "D",
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".title": {
                                "text": "END"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_end.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def on_finish(container, summary):\n    phantom.debug('on_finish() called')\n    # This function is called after all actions are completed.\n    # summary of all the action and/or all details of actions\n    # can be collected here.\n\n    # summary_json = phantom.get_summary()\n    # if 'result' in summary_json:\n        # for action_result in summary_json['result']:\n            # if 'action_run_id' in action_result:\n                # action_results = phantom.get_action_results(action_run_id=action_result['action_run_id'], result_data=False, flatten=False)\n                # phantom.debug(action_results)\n\n    return",
                        "callback_code": "# read-only block view not available",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "file reputation, hunt hash",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "6e953e17-9b70-4c48-b2bd-a13c7a29b009",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "# read-only block view not available",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 339,
                        "line_start": 326,
                        "name": "",
                        "notes": "",
                        "number": 0,
                        "order": 12,
                        "outPorts": [],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1380,
                            "y": 260
                        },
                        "previous_function": "",
                        "previous_name": "",
                        "show_number": true,
                        "size": {
                            "height": 54,
                            "width": 80
                        },
                        "status": "",
                        "title": "END",
                        "type": "coa.StartEnd",
                        "warn": false,
                        "z": 2
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "73526c24-64aa-4846-b4cf-0a8a478c3c81",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "0d75d904-721f-445e-a6e1-b1d349bb4515",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "5e8c9ae4-35bd-49ad-9ea2-ce4ada576dc2",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 3
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "9c65e76f-b0e0-4627-8a21-5c2bbe8163ed",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "5e8c9ae4-35bd-49ad-9ea2-ce4ada576dc2",
                            "port": "out-1",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "a8167b06-2400-4a02-8e58-0f7cd574953b",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 6
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "76b7fac7-397a-49c1-b131-45a2f657b097",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "5e8c9ae4-35bd-49ad-9ea2-ce4ada576dc2",
                            "port": "out-2",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(2) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "7e8a5c86-a3a1-46cb-a45f-df00b5475e2e",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 492
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "9cdc6ec0-3f2d-422b-9931-7b689e992fb0",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "7e8a5c86-a3a1-46cb-a45f-df00b5475e2e",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "6e953e17-9b70-4c48-b2bd-a13c7a29b009",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 494
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "2a6128f3-fcb5-4fcd-b928-40395f0848ce",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "0413c9fc-fee8-433f-ab45-9458da4c6133",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "571ee01f-7cef-4f30-b126-0ab3b76dff25",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 555
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "813dded9-ed1d-42e2-b3fc-df6d5dd20748",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "c040f191-9789-4f2b-b4ed-6ed6265ea45e",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "2e08bb76-1525-4612-ac24-f813b75d0e56",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 556
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "21c2ea70-c3d5-4fb0-bc7a-f7a11e544c51",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "a8167b06-2400-4a02-8e58-0f7cd574953b",
                            "port": "out-1",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "652ffe24-4688-41be-8575-9774f968d7a0",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 583
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "f41243df-438e-453f-bd9a-26ee9053314b",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "652ffe24-4688-41be-8575-9774f968d7a0",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "0413c9fc-fee8-433f-ab45-9458da4c6133",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 589
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "bcfc2c03-5ebe-41c0-9fea-839794a8e866",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "652ffe24-4688-41be-8575-9774f968d7a0",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "c040f191-9789-4f2b-b4ed-6ed6265ea45e",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 590
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "api": "add comment",
                        "attrs": {
                            ".api": {
                                "text": "missing data comment"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "API"
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def missing_data_comment(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('missing_data_comment() called')\n\n    phantom.comment(container=container, comment=\"Missing indicator to execute Indicator Analysis - Filehash playbook.  Check logic and playbook parameters\")\n\n    container = phantom.get_container(container.get('id', None))\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "color": "",
                        "configured": [
                            {
                                "addCommentComment": "Missing indicator to execute Indicator Analysis - Filehash playbook.  Check logic and playbook parameters",
                                "key": "add-comment"
                            }
                        ],
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "missing data comment",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "7e8a5c86-a3a1-46cb-a45f-df00b5475e2e",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 236,
                        "line_start": 227,
                        "message": "Configuring now",
                        "name": "add comment",
                        "notes": "Adds a missing data comment, assigned to administrators and opens event",
                        "number": 3,
                        "order": 8,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": -100,
                            "y": 240
                        },
                        "previous_function": "",
                        "previous_name": "missing_data_comment",
                        "refetch_container": true,
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "api",
                        "status": "",
                        "title": "API",
                        "type": "coa.API",
                        "warn": false,
                        "z": 660
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#637282",
                                "transform": "rotate(45 30 70)"
                            },
                            ".inPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".number": {
                                "text": 1
                            },
                            ".outPorts>.port-0": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                },
                                "ref-x": 83,
                                "ref-y": 40
                            },
                            ".outPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".outPorts>.port-1": {
                                "port": {
                                    "id": "out-2",
                                    "type": "out"
                                },
                                "ref-x": 41,
                                "ref-y": 82
                            },
                            ".outPorts>.port-1>.port-body": {
                                "port": {
                                    "id": "out-2",
                                    "type": "out"
                                }
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def check_fileHash(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('check_fileHash() called')\n\n    # check for 'if' condition 1\n    matched = phantom.decision(\n        container=container,\n        conditions=[\n            [\"artifact:*.cef.fileHash\", \"!=\", \"\"],\n            [\"artifact:*.cef.fileHashMd5\", \"!=\", \"\"],\n            [\"artifact:*.cef.fileHashSha1\", \"!=\", \"\"],\n            [\"artifact:*.cef.fileHashSha256\", \"!=\", \"\"],\n            [\"artifact:*.cef.fileHashSha512\", \"!=\", \"\"],\n            [\"artifact:*.cef.hash\", \"!=\", \"\"],\n        ],\n        logical_operator='or')\n\n    # call connected blocks if condition 1 matched\n    if matched:\n        fileHash_filter(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function)\n        return\n\n    # call connected blocks for 'else' condition 2\n    missing_data_comment(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "check fileHash",
                        "description": "",
                        "hasElse": true,
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "5e8c9ae4-35bd-49ad-9ea2-ce4ada576dc2",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 51,
                        "line_start": 25,
                        "name": "decision",
                        "notes": "Check for fileHash and if missing provide a comment that no hashes were found.\n\nGREEN: if fileHash exists\n\nPURPLE: if missing add a comment of missing artifact",
                        "number": 1,
                        "order": 2,
                        "outPorts": [
                            "out-1",
                            "out-2"
                        ],
                        "outputs": [
                            {
                                "conditions": [
                                    {
                                        "comparison": "!=",
                                        "data_type": "",
                                        "param": "artifact:*.cef.fileHash",
                                        "value": ""
                                    },
                                    {
                                        "comparison": "!=",
                                        "data_type": "",
                                        "param": "artifact:*.cef.fileHashMd5",
                                        "value": ""
                                    },
                                    {
                                        "comparison": "!=",
                                        "data_type": "",
                                        "param": "artifact:*.cef.fileHashSha1",
                                        "value": ""
                                    },
                                    {
                                        "comparison": "!=",
                                        "data_type": "",
                                        "param": "artifact:*.cef.fileHashSha256",
                                        "value": ""
                                    },
                                    {
                                        "comparison": "!=",
                                        "data_type": "",
                                        "param": "artifact:*.cef.fileHashSha512",
                                        "value": ""
                                    },
                                    {
                                        "comparison": "!=",
                                        "data_type": "",
                                        "param": "artifact:*.cef.hash",
                                        "value": ""
                                    }
                                ],
                                "display": "If",
                                "logic": "or",
                                "type": "if"
                            },
                            {
                                "conditions": [
                                    {
                                        "comparison": "==",
                                        "data_type": "",
                                        "param": "",
                                        "value": ""
                                    }
                                ],
                                "display": "Else",
                                "logic": "and",
                                "type": "else"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": -180,
                            "y": -80
                        },
                        "previous_function": "",
                        "previous_name": "check_fileHash",
                        "show_number": true,
                        "size": {
                            "height": 82,
                            "width": 82
                        },
                        "state": "decision",
                        "status": "",
                        "type": "coa.Decision",
                        "warn": "",
                        "z": 664
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773",
                                "transform": "rotate(45 30 70)"
                            },
                            ".inPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".number": {
                                "text": 1
                            },
                            ".outPorts>.port-0": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                },
                                "ref-x": 83,
                                "ref-y": 40
                            },
                            ".outPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def fileHash_filter(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('fileHash_filter() called')\n\n    # collect filtered artifact ids for 'if' condition 1\n    matched_artifacts_1, matched_results_1 = phantom.condition(\n        container=container,\n        conditions=[\n            [\"artifact:*.cef.fileHash\", \"not in\", \"custom_list:bogon_list\"],\n            [\"artifact:*.cef.fileHashMd5\", \"not in\", \"custom_list:bogon_list\"],\n            [\"artifact:*.cef.fileHashSha1\", \"not in\", \"custom_list:bogon_list\"],\n            [\"artifact:*.cef.fileHashSha256\", \"not in\", \"custom_list:bogon_list\"],\n            [\"artifact:*.cef.fileHashSha512\", \"not in\", \"custom_list:bogon_list\"],\n            [\"artifact:*.cef.hash\", \"not in\", \"custom_list:bogon_list\"],\n        ],\n        logical_operator='or',\n        name=\"fileHash_filter:condition_1\")\n\n    # call connected blocks if filtered artifacts or results\n    if matched_artifacts_1 or matched_results_1:\n        merge_list(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function, filtered_artifacts=matched_artifacts_1, filtered_results=matched_results_1)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "fileHash filter",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "a8167b06-2400-4a02-8e58-0f7cd574953b",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 74,
                        "line_start": 51,
                        "name": "filter",
                        "notes": "Filters for fileHash(s) and removes allowed list objects from custom_list:bogon_list\n\nGREEN: if fileHash exists otherwise exit and return to main code block",
                        "number": 1,
                        "order": 3,
                        "outPorts": [
                            "out-1"
                        ],
                        "outputs": [
                            {
                                "conditions": [
                                    {
                                        "comparison": "not in",
                                        "data_type": "",
                                        "param": "artifact:*.cef.fileHash",
                                        "value": "custom_list:bogon_list"
                                    },
                                    {
                                        "comparison": "not in",
                                        "data_type": "",
                                        "param": "artifact:*.cef.fileHashMd5",
                                        "value": "custom_list:bogon_list"
                                    },
                                    {
                                        "comparison": "not in",
                                        "data_type": "",
                                        "param": "artifact:*.cef.fileHashSha1",
                                        "value": "custom_list:bogon_list"
                                    },
                                    {
                                        "comparison": "not in",
                                        "data_type": "",
                                        "param": "artifact:*.cef.fileHashSha256",
                                        "value": "custom_list:bogon_list"
                                    },
                                    {
                                        "comparison": "not in",
                                        "data_type": "",
                                        "param": "artifact:*.cef.fileHashSha512",
                                        "value": "custom_list:bogon_list"
                                    },
                                    {
                                        "comparison": "not in",
                                        "data_type": "",
                                        "param": "artifact:*.cef.hash",
                                        "value": "custom_list:bogon_list"
                                    }
                                ],
                                "display": "If",
                                "logic": "or",
                                "type": "if"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": -40,
                            "y": -80
                        },
                        "previous_function": "",
                        "previous_name": "fileHash_filter",
                        "show_number": true,
                        "size": {
                            "height": 82,
                            "width": 82
                        },
                        "state": "filter",
                        "status": "",
                        "type": "coa.Filter",
                        "warn": false,
                        "z": 665
                    },
                    {
                        "action": "file reputation",
                        "action_type": "investigate",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "hash": "merge_list:custom_function_result.data.*.item",
                            "ip": "filtered-data:fileHash_filter:condition_1:artifact:*.cef.sourceAddress"
                        },
                        "angle": 0,
                        "app": "",
                        "appid": "11f676a4-f3d4-4db0-8587-f4e942c07c7c",
                        "approver": "",
                        "assets": [
                            {
                                "action": "file reputation",
                                "actions": [
                                    "detonate url",
                                    "detonate file",
                                    "get report",
                                    "get file",
                                    "ip reputation",
                                    "domain reputation",
                                    "url reputation",
                                    "file reputation",
                                    "test connectivity"
                                ],
                                "active": true,
                                "app_name": "VirusTotal",
                                "app_version": "2.1.2",
                                "appid": "11f676a4-f3d4-4db0-8587-f4e942c07c7c",
                                "asset_name": "vt",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "hash": "merge_list:custom_function_result.data.*.item"
                                },
                                "has_app": true,
                                "id": 15,
                                "loaded": false,
                                "missing": false,
                                "name": "vt",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string",
                                        "example_values": [
                                            "success",
                                            "failed"
                                        ]
                                    },
                                    {
                                        "column_name": "Hash",
                                        "column_order": 0,
                                        "contains": [
                                            "hash",
                                            "sha256",
                                            "sha1",
                                            "md5"
                                        ],
                                        "data_path": "action_result.parameter.hash",
                                        "data_type": "string",
                                        "example_values": [
                                            "e87051ea8e1bb3c986c0f0bda85352f63e67e0315c58e461a075b5fb7229e6fe"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.authentihash",
                                        "data_type": "string",
                                        "example_values": [
                                            "ad56160b465f7bd1e7568640397f01fc4f8819ce6f0c1415690ecee646464cec"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.creation_date",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1410950077
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.first_submission_date",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1612961082
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.last_analysis_date",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1613635130
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.last_analysis_results.*.category",
                                        "data_type": "string",
                                        "example_values": [
                                            "undetected"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.last_analysis_results.*.engine_name",
                                        "data_type": "string",
                                        "example_values": [
                                            "CMC"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.last_analysis_results.*.engine_update",
                                        "data_type": "string",
                                        "example_values": [
                                            "20210218"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.last_analysis_results.*.engine_version",
                                        "data_type": "string",
                                        "example_values": [
                                            "2.10.2019.1"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.last_analysis_results.*.method",
                                        "data_type": "string",
                                        "example_values": [
                                            "blacklist"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.last_analysis_results.*.result",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.last_analysis_results.*.vendor",
                                        "data_type": "string",
                                        "example_values": [
                                            "Symantec"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.last_analysis_stats.confirmed-timeout",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.last_analysis_stats.failure",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.last_analysis_stats.harmless",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.last_analysis_stats.malicious",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.last_analysis_stats.suspicious",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.last_analysis_stats.timeout",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.last_analysis_stats.type-unsupported",
                                        "data_type": "numeric",
                                        "example_values": [
                                            16
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.last_analysis_stats.undetected",
                                        "data_type": "numeric",
                                        "example_values": [
                                            59
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.last_modification_date",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1613635210
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.last_submission_date",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1613635130
                                        ]
                                    },
                                    {
                                        "column_name": "File Description",
                                        "column_order": 2,
                                        "data_path": "action_result.data.*.attributes.magic",
                                        "data_type": "string",
                                        "example_values": [
                                            "a python2.7\\015script text executable"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "md5"
                                        ],
                                        "data_path": "action_result.data.*.attributes.md5",
                                        "data_type": "string",
                                        "example_values": [
                                            "2e65153f2c49c91a0206ee7a8c00e659"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.meaningful_name",
                                        "data_type": "string",
                                        "example_values": [
                                            "update_cr.py"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.names",
                                        "data_type": "string",
                                        "example_values": [
                                            "update_cr.py"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.pe_info.entry_point",
                                        "data_type": "numeric",
                                        "example_values": [
                                            14768
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.pe_info.imphash",
                                        "data_type": "string",
                                        "example_values": [
                                            "d7584447a5c5ca9b4a55946317137951"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.pe_info.import_list.*.library_name",
                                        "data_type": "string",
                                        "example_values": [
                                            "COMDLG32.dll"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.pe_info.machine_type",
                                        "data_type": "numeric",
                                        "example_values": [
                                            332
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.pe_info.resource_details.*.chi2",
                                        "data_type": "numeric",
                                        "example_values": [
                                            8137.34814453125
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.pe_info.resource_details.*.entropy",
                                        "data_type": "numeric",
                                        "example_values": [
                                            5.789552211761475
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.pe_info.resource_details.*.filetype",
                                        "data_type": "string",
                                        "example_values": [
                                            "Data"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.pe_info.resource_details.*.lang",
                                        "data_type": "string",
                                        "example_values": [
                                            "ENGLISH US"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.pe_info.resource_details.*.sha256",
                                        "data_type": "string",
                                        "example_values": [
                                            "c37bc8f6dbf81e8d88978836b23ee932ade6652ba798989bf20697afffd6113e"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.pe_info.resource_details.*.type",
                                        "data_type": "string",
                                        "example_values": [
                                            "RT_BITMAP"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.pe_info.resource_langs.ENGLISH US",
                                        "data_type": "numeric",
                                        "example_values": [
                                            6
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.pe_info.resource_langs.RUSSIAN",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.pe_info.resource_types.RT_BITMAP",
                                        "data_type": "numeric",
                                        "example_values": [
                                            2
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.pe_info.resource_types.RT_DIALOG",
                                        "data_type": "numeric",
                                        "example_values": [
                                            2
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.pe_info.resource_types.RT_MANIFEST",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.pe_info.resource_types.RT_MENU",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.pe_info.resource_types.RT_VERSION",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.pe_info.rich_pe_header_hash",
                                        "data_type": "string",
                                        "example_values": [
                                            "fa4dbca9180170710b3c245464efa483"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.pe_info.sections.*.chi2",
                                        "data_type": "numeric",
                                        "example_values": [
                                            292981.44
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.pe_info.sections.*.entropy",
                                        "data_type": "numeric",
                                        "example_values": [
                                            6.75
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.pe_info.sections.*.flags",
                                        "data_type": "string",
                                        "example_values": [
                                            "rx"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.pe_info.sections.*.md5",
                                        "data_type": "string",
                                        "example_values": [
                                            "a13f88c3e0636712e10326c07d56b645"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.pe_info.sections.*.name",
                                        "data_type": "string",
                                        "example_values": [
                                            ".text"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.pe_info.sections.*.raw_size",
                                        "data_type": "numeric",
                                        "example_values": [
                                            54784
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.pe_info.sections.*.virtual_address",
                                        "data_type": "numeric",
                                        "example_values": [
                                            4096
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.pe_info.sections.*.virtual_size",
                                        "data_type": "numeric",
                                        "example_values": [
                                            54434
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.pe_info.timestamp",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1410950077
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.popular_threat_classification.popular_threat_category.*.count",
                                        "data_type": "numeric",
                                        "example_values": [
                                            30
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.popular_threat_classification.popular_threat_category.*.value",
                                        "data_type": "string",
                                        "example_values": [
                                            "trojan"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.popular_threat_classification.popular_threat_name.*.count",
                                        "data_type": "numeric",
                                        "example_values": [
                                            13
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.popular_threat_classification.popular_threat_name.*.value",
                                        "data_type": "string",
                                        "example_values": [
                                            "zbot"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.popular_threat_classification.suggested_threat_label",
                                        "data_type": "string",
                                        "example_values": [
                                            "trojan.zbot/foreign"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.reputation",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.sandbox_verdicts.Tencent HABO.*",
                                        "data_type": "string",
                                        "example_values": [
                                            "xyz"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "sha1"
                                        ],
                                        "data_path": "action_result.data.*.attributes.sha1",
                                        "data_type": "string",
                                        "example_values": [
                                            "6802169a19142292710254cde97df84e46dfe33a"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "sha256"
                                        ],
                                        "data_path": "action_result.data.*.attributes.sha256",
                                        "data_type": "string",
                                        "example_values": [
                                            "e87051ea8e1bb3c986c0f0bda85352f63e67e0315c58e461a075b5fb7229e6fe"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.signature_info.*",
                                        "data_type": "string",
                                        "example_values": [
                                            "xyz"
                                        ]
                                    },
                                    {
                                        "column_name": "Size",
                                        "column_order": 1,
                                        "data_path": "action_result.data.*.attributes.size",
                                        "data_type": "numeric",
                                        "example_values": [
                                            6285
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.ssdeep",
                                        "data_type": "string",
                                        "example_values": [
                                            "192:MPv2vv/ybXAhgPpyN3ipdw0fRAdygi6OLxgUHzYu7ThPBLkv:pq7Mgg0/NdMu/1BLkv"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.tags",
                                        "data_type": "string",
                                        "example_values": [
                                            "python"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.times_submitted",
                                        "data_type": "numeric",
                                        "example_values": [
                                            13
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.tlsh",
                                        "data_type": "string",
                                        "example_values": [
                                            "T1F7D10E05AC5E941C47329D1EDD16FD1BEB0122B724296327B46CA2997FB0468C3E14FC"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.total_votes.harmless",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.total_votes.malicious",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.trid.*.file_type",
                                        "data_type": "string",
                                        "example_values": [
                                            "Unix-like shebang (var.1) (gen)"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.trid.*.probability",
                                        "data_type": "numeric",
                                        "example_values": [
                                            100
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.type_description",
                                        "data_type": "string",
                                        "example_values": [
                                            "Python"
                                        ]
                                    },
                                    {
                                        "column_name": "File Extension",
                                        "column_order": 3,
                                        "data_path": "action_result.data.*.attributes.type_extension",
                                        "data_type": "string",
                                        "example_values": [
                                            "py"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.type_tag",
                                        "data_type": "string",
                                        "example_values": [
                                            "python"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.unique_sources",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.attributes.vhash",
                                        "data_type": "string",
                                        "example_values": [
                                            "025056657d755510804011z9005b9z25z12z3afz"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "sha256"
                                        ],
                                        "data_path": "action_result.data.*.id",
                                        "data_type": "string",
                                        "example_values": [
                                            "e87051ea8e1bb3c986c0f0bda85352f63e67e0315c58e461a075b5fb7229e6fe"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "url"
                                        ],
                                        "data_path": "action_result.data.*.links.self",
                                        "data_type": "string",
                                        "example_values": [
                                            "https://www.virustotal.com/api/v3/files/e87051ea8e1bb3c986c0f0bda85352f63e67e0315c58e461a075b5fb7229e6fe"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.type",
                                        "data_type": "string",
                                        "example_values": [
                                            "file"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.harmless",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.malicious",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.suspicious",
                                        "data_type": "numeric",
                                        "example_values": [
                                            0
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.undetected",
                                        "data_type": "numeric",
                                        "example_values": [
                                            59
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string",
                                        "example_values": [
                                            "Harmless: 0, Malicious: 0, Suspicious: 0, Undetected: 59"
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    }
                                ],
                                "parameters": {
                                    "hash": {
                                        "contains": [
                                            "hash",
                                            "sha256",
                                            "sha1",
                                            "md5"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "File hash to query",
                                        "key": "hash",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    }
                                },
                                "product_name": "VirusTotal",
                                "product_vendor": "VirusTotal",
                                "targets": "15",
                                "type": "reputation"
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "file reputation"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Investigate"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_investigate.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def file_reputation(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('file_reputation() called')\n        \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'file_reputation' call\n    custom_function_results_data_1 = phantom.collect2(container=container, datapath=['merge_list:custom_function_result.data.*.item'], action_results=results)\n\n    parameters = []\n    \n    # build parameters list for 'file_reputation' call\n    for custom_function_results_item_1 in custom_function_results_data_1:\n        if custom_function_results_item_1[0]:\n            parameters.append({\n                'hash': custom_function_results_item_1[0],\n            })\n\n    phantom.act(action=\"file reputation\", parameters=parameters, assets=['vt'], callback=reputation_format, name=\"file_reputation\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "merge list",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "file reputation",
                        "delay": 0,
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "0413c9fc-fee8-433f-ab45-9458da4c6133",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 95,
                        "line_start": 74,
                        "message": "Configuring now",
                        "name": "file reputation",
                        "notes": "Gets IP reputation for the destinationAddress  provided from VirusTotal",
                        "number": 2,
                        "order": 4,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 360,
                            "y": -80
                        },
                        "previous_function": "",
                        "previous_name": "file_reputation",
                        "required_params": {
                            "hash": true
                        },
                        "reviewer": "",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "action_assets",
                        "status": "",
                        "title": "Investigate",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 676
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "32394523-e0b3-471b-bd66-ff4379e641db",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "571ee01f-7cef-4f30-b126-0ab3b76dff25",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "804903c7-671e-41c4-bc92-43888f210a07",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 678
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "e84b3470-9e0c-484b-ac93-984e21e7c2d8",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "2e08bb76-1525-4612-ac24-f813b75d0e56",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "804903c7-671e-41c4-bc92-43888f210a07",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 681
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "7fa2cb4c-fbb6-445e-8815-bdaacdcce12a",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "804903c7-671e-41c4-bc92-43888f210a07",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "4ddef5dc-4bef-44e3-be34-9e4e9a96fac8",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 683
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".format": {
                                "text": "format 13"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out-1": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out-1>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "format"
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def format_13(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('format_13() called')\n    \n    template = \"\"\"{0}  \n{1}\"\"\"\n\n    # parameter list for template variable replacement\n    parameters = [\n        \"reputation_format:formatted_data\",\n        \"hunt_hash_format:formatted_data\",\n    ]\n\n    phantom.format(container=container, template=template, parameters=parameters, name=\"format_13\", separator=\", \")\n\n    add_note_5(container=container)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "file reputation, hunt hash",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "delimiter": ", ",
                        "description": "",
                        "format": "format",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "804903c7-671e-41c4-bc92-43888f210a07",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "def join_format_13(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None):\n    phantom.debug('join_format_13() called')\n\n    # check if all connected incoming playbooks, actions, or custom functions are done i.e. have succeeded or failed\n    if phantom.completed(action_names=['file_reputation', 'hunt_hash']):\n        \n        # call connected block \"format_13\"\n        format_13(container=container, handle=handle)\n    \n    return",
                        "join_optional": [],
                        "join_start": 301,
                        "line_end": 312,
                        "line_start": 283,
                        "message": "Configuring now",
                        "name": "format",
                        "notes": "",
                        "number": 13,
                        "order": 10,
                        "outPorts": [
                            "out-1"
                        ],
                        "parameters": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "reputation_format:formatted_data"
                            },
                            {
                                "position": 1,
                                "type": "",
                                "value": "hunt_hash_format:formatted_data"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 860,
                            "y": -80
                        },
                        "previous_function": "",
                        "previous_name": "format_13",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "format",
                        "status": "",
                        "template": "{0}  \n{1}",
                        "title": "format",
                        "type": "coa.Format",
                        "warn": false,
                        "z": 684
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "api": "add note",
                        "attrs": {
                            ".api": {
                                "text": "add note"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "API"
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def add_note_5(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('add_note_5() called')\n\n    formatted_data_1 = phantom.get_format_data(name='format_13')\n\n    note_title = \"File Reputation Results\"\n    note_content = formatted_data_1\n    note_format = \"markdown\"\n    phantom.add_note(container=container, note_type=\"general\", title=note_title, content=note_content, note_format=note_format)\n\n    container = phantom.get_container(container.get('id', None))\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "color": "",
                        "configured": [
                            {
                                "addNoteContent": "format_13:formatted_data",
                                "addNoteNoteFormat": "markdown",
                                "addNoteTitle": "File Reputation Results",
                                "key": "add-note"
                            }
                        ],
                        "connected_to_start": true,
                        "connection_name": "file reputation, hunt hash",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "4ddef5dc-4bef-44e3-be34-9e4e9a96fac8",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 326,
                        "line_start": 312,
                        "message": "Configuring now",
                        "name": "add note",
                        "notes": "",
                        "number": 5,
                        "order": 11,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1100,
                            "y": -80
                        },
                        "previous_function": "",
                        "previous_name": "add_note_5",
                        "refetch_container": true,
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "api",
                        "status": "",
                        "title": "API",
                        "type": "coa.API",
                        "warn": false,
                        "z": 685
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "5fb86e1c-bcaf-4d4f-8fed-ff6a38dd9e15",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "4ddef5dc-4bef-44e3-be34-9e4e9a96fac8",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "6e953e17-9b70-4c48-b2bd-a13c7a29b009",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 686
                    },
                    {
                        "action": "hunt hash",
                        "action_type": "investigate",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "hash": "merge_list:custom_function_result.data.*.item",
                            "ip": "filtered-data:fileHash_filter:condition_1:artifact:*.cef.sourceAddress"
                        },
                        "angle": 0,
                        "app": "",
                        "appid": "8383852c-43dc-4356-ac81-4e6dd65ee23e",
                        "approver": "",
                        "assets": [
                            {
                                "action": "hunt hash",
                                "actions": [
                                    "search terms",
                                    "hunt similar",
                                    "hunt ip",
                                    "hunt hash",
                                    "hunt file",
                                    "hunt malware family",
                                    "hunt domain",
                                    "hunt url",
                                    "get file from url",
                                    "get pcap",
                                    "get file",
                                    "get report",
                                    "check status",
                                    "check url hash",
                                    "detonate url",
                                    "detonate online file",
                                    "detonate file",
                                    "test connectivity"
                                ],
                                "active": true,
                                "app_name": "Falcon Sandbox",
                                "app_version": "1.1.6",
                                "appid": "8383852c-43dc-4356-ac81-4e6dd65ee23e",
                                "asset_name": "ha",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "hash": "merge_list:custom_function_result.data.*.item"
                                },
                                "has_app": true,
                                "id": 17,
                                "loaded": false,
                                "missing": false,
                                "name": "ha",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Submit Name",
                                        "column_order": 0,
                                        "contains": [
                                            "file name"
                                        ],
                                        "data_path": "action_result.data.*.submit_name",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Job Id",
                                        "column_order": 1,
                                        "contains": [
                                            "falcon sandbox job id"
                                        ],
                                        "data_path": "action_result.data.*.job_id",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Sample Sha256",
                                        "column_order": 2,
                                        "contains": [
                                            "sha256"
                                        ],
                                        "data_path": "action_result.data.*.sha256",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Environment",
                                        "column_order": 3,
                                        "data_path": "action_result.data.*.environment",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.type",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.environment_id",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.data.*.environment_description",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Verdict",
                                        "column_order": 4,
                                        "contains": [
                                            "falcon sandbox verdict"
                                        ],
                                        "data_path": "action_result.data.*.verdict",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.threat_score",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Threat Score",
                                        "column_order": 5,
                                        "data_path": "action_result.data.*.threat_score_verbose",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary.found",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.summary.found_by_verdict_name.unknown",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.summary.found_by_verdict_name.no_verdict",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.summary.found_by_verdict_name.no_specific_threat",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.summary.found_by_verdict_name.whitelisted",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.summary.found_by_verdict_name.suspicious",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.summary.found_by_verdict_name.malicious",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "contains": [
                                            "sha256",
                                            "sha1",
                                            "md5"
                                        ],
                                        "data_path": "action_result.parameter.hash",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric"
                                    }
                                ],
                                "parameters": {
                                    "hash": {
                                        "contains": [
                                            "sha256",
                                            "sha1",
                                            "md5"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Sha1, Md5, Sha256",
                                        "key": "hash",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    }
                                },
                                "product_name": "Falcon Sandbox",
                                "product_vendor": "Hybrid Analysis",
                                "targets": "17",
                                "type": "sandbox"
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "hunt hash"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Investigate"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_investigate.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def hunt_hash(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('hunt_hash() called')\n        \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'hunt_hash' call\n    custom_function_results_data_1 = phantom.collect2(container=container, datapath=['merge_list:custom_function_result.data.*.item'], action_results=results)\n\n    parameters = []\n    \n    # build parameters list for 'hunt_hash' call\n    for custom_function_results_item_1 in custom_function_results_data_1:\n        if custom_function_results_item_1[0]:\n            parameters.append({\n                'hash': custom_function_results_item_1[0],\n            })\n\n    phantom.act(action=\"hunt hash\", parameters=parameters, assets=['ha'], callback=hunt_hash_format, name=\"hunt_hash\")\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "merge list",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "hunt hash",
                        "delay": 0,
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "c040f191-9789-4f2b-b4ed-6ed6265ea45e",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 181,
                        "line_start": 160,
                        "message": "Configuring now",
                        "name": "hunt hash",
                        "notes": "Hunts hash against sandbox resource",
                        "number": 1,
                        "order": 6,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 360,
                            "y": 40
                        },
                        "previous_function": "",
                        "previous_name": "hunt_hash",
                        "required_params": {
                            "hash": true
                        },
                        "reviewer": "",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "action_assets",
                        "status": "",
                        "title": "Investigate",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 687
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".format": {
                                "text": "hunt hash format"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out-1": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out-1>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "format"
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def hunt_hash_format(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('hunt_hash_format() called')\n    \n    template = \"\"\"%%\n### Falcon Sandbox Summary of {0}: *{1}, {2} - {3}*\n\n*Hybrid Analysis Link: https://hybrid-analysis.com/sample/{10}*\n\n| Data| Result |\n| --- | --- |\n| VX family | {4} |\n| Scan date |  {5} |\n| Name(s) | {6} |\n| Environment | {7} |\n| Type | {8} | \n| sha1 | {9} | \n| sha256 | {10} | \n| imphash | {11} |\n| ssdeep | {12} |\n\n---\n%%\"\"\"\n\n    # parameter list for template variable replacement\n    parameters = [\n        \"hunt_hash:action_result.parameter.hash\",\n        \"hunt_hash:action_result.message\",\n        \"hunt_hash:action_result.data.*.verdict\",\n        \"hunt_hash:action_result.data.*.threat_score_verbose\",\n        \"hunt_hash:action_result.data.*.vx_family\",\n        \"hunt_hash:action_result.data.*.analysis_start_time\",\n        \"hunt_hash:action_result.data.*.submit_name\",\n        \"hunt_hash:action_result.data.*.environment\",\n        \"hunt_hash:action_result.data.*.type\",\n        \"hunt_hash:action_result.data.*.sha1\",\n        \"hunt_hash:action_result.data.*.sha256\",\n        \"hunt_hash:action_result.data.*.imphash\",\n        \"hunt_hash:action_result.data.*.ssdeep\",\n    ]\n\n    phantom.format(container=container, template=template, parameters=parameters, name=\"hunt_hash_format\", separator=\", \")\n\n    join_format_13(container=container)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "hunt hash",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "hunt hash format",
                        "delimiter": ", ",
                        "description": "",
                        "format": "format",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "2e08bb76-1525-4612-ac24-f813b75d0e56",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 227,
                        "line_start": 181,
                        "message": "Configuring now",
                        "name": "format",
                        "notes": "Create detonated information format for note",
                        "number": 12,
                        "order": 7,
                        "outPorts": [
                            "out-1"
                        ],
                        "parameters": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "hunt_hash:action_result.parameter.hash"
                            },
                            {
                                "position": 0,
                                "type": "",
                                "value": "hunt_hash:action_result.message"
                            },
                            {
                                "position": 2,
                                "type": "",
                                "value": "hunt_hash:action_result.data.*.verdict"
                            },
                            {
                                "position": 3,
                                "type": "",
                                "value": "hunt_hash:action_result.data.*.threat_score_verbose"
                            },
                            {
                                "position": 4,
                                "type": "",
                                "value": "hunt_hash:action_result.data.*.vx_family"
                            },
                            {
                                "position": 0,
                                "type": "",
                                "value": "hunt_hash:action_result.data.*.analysis_start_time"
                            },
                            {
                                "position": 1,
                                "type": "",
                                "value": "hunt_hash:action_result.data.*.submit_name"
                            },
                            {
                                "position": 2,
                                "type": "",
                                "value": "hunt_hash:action_result.data.*.environment"
                            },
                            {
                                "position": 3,
                                "type": "",
                                "value": "hunt_hash:action_result.data.*.type"
                            },
                            {
                                "position": 9,
                                "type": "",
                                "value": "hunt_hash:action_result.data.*.sha1"
                            },
                            {
                                "position": 10,
                                "type": "",
                                "value": "hunt_hash:action_result.data.*.sha256"
                            },
                            {
                                "position": 11,
                                "type": "",
                                "value": "hunt_hash:action_result.data.*.imphash"
                            },
                            {
                                "position": 12,
                                "type": "",
                                "value": "hunt_hash:action_result.data.*.ssdeep"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 600,
                            "y": 40
                        },
                        "previous_function": "",
                        "previous_name": "hunt_hash_format",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "format",
                        "status": "",
                        "template": "%%\n### Falcon Sandbox Summary of {0}: *{1}, {2} - {3}*\n\n*Hybrid Analysis Link: https://hybrid-analysis.com/sample/{10}*\n\n| Data| Result |\n| --- | --- |\n| VX family | {4} |\n| Scan date |  {5} |\n| Name(s) | {6} |\n| Environment | {7} |\n| Type | {8} | \n| sha1 | {9} | \n| sha256 | {10} | \n| imphash | {11} |\n| ssdeep | {12} |\n\n---\n%%",
                        "title": "format",
                        "type": "coa.Format",
                        "warn": false,
                        "z": 689
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".format": {
                                "text": "reputation format"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out-1": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out-1>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "format"
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def reputation_format(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('reputation_format() called')\n    \n    template = \"\"\"%%\n### VirusTotal Summary of {0}: *{1}, {2}*\n\n*VTI link: {3}*\n\nScan Date: {4}\n- sha1: {5}\n- sha256: {6}\n\n| Scanner | Detected | Result |\n| ---- | ---- | ---- |\n| CrowdStrike | {7} | {8} |\n| Cylance | {9} | {10} |\n| ESET | {11} | {12} |\n| FireEye | {13} | {14} |\n| MalwareBytes | {15} | {16} |\n| McAfee | {17} | {18} | \n| McAfee Gateway | {19} | {20} |\n| Microsoft | {21} | {22} |\n| Symantec | {23} | {24} | \n| Sophos | {25} | {26}\n\n---\n%%\"\"\"\n\n    # parameter list for template variable replacement\n    parameters = [\n        \"file_reputation:action_result.parameter.hash\",\n        \"file_reputation:action_result.message\",\n        \"file_reputation:action_result.data.*.verbose_msg\",\n        \"file_reputation:action_result.data.*.permalink\",\n        \"file_reputation:action_result.data.*.scan_date\",\n        \"file_reputation:action_result.data.*.sha1\",\n        \"file_reputation:action_result.data.*.sha256\",\n        \"file_reputation:action_result.data.*.scans.CrowdStrike.detected\",\n        \"file_reputation:action_result.data.*.scans.CrowdStrike.result\",\n        \"file_reputation:action_result.data.*.scans.Cylance.detected\",\n        \"file_reputation:action_result.data.*.scans.Cylance.result\",\n        \"file_reputation:action_result.data.*.scans.ESET-NOD32.detected\",\n        \"file_reputation:action_result.data.*.scans.ESET-NOD32.result\",\n        \"file_reputation:action_result.data.*.scans.FireEye.detected\",\n        \"file_reputation:action_result.data.*.scans.FireEye.result\",\n        \"file_reputation:action_result.data.*.scans.Malwarebytes.detected\",\n        \"file_reputation:action_result.data.*.scans.Malwarebytes.result\",\n        \"file_reputation:action_result.data.*.scans.McAfee.detected\",\n        \"file_reputation:action_result.data.*.scans.McAfee.result\",\n        \"file_reputation:action_result.data.*.scans.McAfee-GW-Edition.detected\",\n        \"file_reputation:action_result.data.*.scans.McAfee-GW-Edition.result\",\n        \"file_reputation:action_result.data.*.scans.Microsoft.detected\",\n        \"file_reputation:action_result.data.*.scans.Microsoft.result\",\n        \"file_reputation:action_result.data.*.scans.Symantec.detected\",\n        \"file_reputation:action_result.data.*.scans.Symantec.result\",\n        \"file_reputation:action_result.data.*.scans.Sophos.detected\",\n        \"file_reputation:action_result.data.*.scans.Sophos.result\",\n    ]\n\n    phantom.format(container=container, template=template, parameters=parameters, name=\"reputation_format\", separator=\", \")\n\n    join_format_13(container=container)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "file reputation",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "reputation format",
                        "delimiter": ", ",
                        "description": "",
                        "format": "format",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "571ee01f-7cef-4f30-b126-0ab3b76dff25",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 160,
                        "line_start": 95,
                        "message": "Configuring now",
                        "name": "format",
                        "notes": "Create reputation information format for note",
                        "number": 10,
                        "order": 5,
                        "outPorts": [
                            "out-1"
                        ],
                        "parameters": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "file_reputation:action_result.parameter.hash"
                            },
                            {
                                "position": 1,
                                "type": "",
                                "value": "file_reputation:action_result.message"
                            },
                            {
                                "position": 1,
                                "type": "",
                                "value": "file_reputation:action_result.data.*.verbose_msg"
                            },
                            {
                                "position": 1,
                                "type": "",
                                "value": "file_reputation:action_result.data.*.permalink"
                            },
                            {
                                "position": 3,
                                "type": "",
                                "value": "file_reputation:action_result.data.*.scan_date"
                            },
                            {
                                "position": 4,
                                "type": "",
                                "value": "file_reputation:action_result.data.*.sha1"
                            },
                            {
                                "position": 5,
                                "type": "",
                                "value": "file_reputation:action_result.data.*.sha256"
                            },
                            {
                                "position": 7,
                                "type": "",
                                "value": "file_reputation:action_result.data.*.scans.CrowdStrike.detected"
                            },
                            {
                                "position": 8,
                                "type": "",
                                "value": "file_reputation:action_result.data.*.scans.CrowdStrike.result"
                            },
                            {
                                "position": 9,
                                "type": "",
                                "value": "file_reputation:action_result.data.*.scans.Cylance.detected"
                            },
                            {
                                "position": 10,
                                "type": "",
                                "value": "file_reputation:action_result.data.*.scans.Cylance.result"
                            },
                            {
                                "position": 11,
                                "type": "",
                                "value": "file_reputation:action_result.data.*.scans.ESET-NOD32.detected"
                            },
                            {
                                "position": 12,
                                "type": "",
                                "value": "file_reputation:action_result.data.*.scans.ESET-NOD32.result"
                            },
                            {
                                "position": 13,
                                "type": "",
                                "value": "file_reputation:action_result.data.*.scans.FireEye.detected"
                            },
                            {
                                "position": 14,
                                "type": "",
                                "value": "file_reputation:action_result.data.*.scans.FireEye.result"
                            },
                            {
                                "position": 15,
                                "type": "",
                                "value": "file_reputation:action_result.data.*.scans.Malwarebytes.detected"
                            },
                            {
                                "position": 16,
                                "type": "",
                                "value": "file_reputation:action_result.data.*.scans.Malwarebytes.result"
                            },
                            {
                                "position": 17,
                                "type": "",
                                "value": "file_reputation:action_result.data.*.scans.McAfee.detected"
                            },
                            {
                                "position": 18,
                                "type": "",
                                "value": "file_reputation:action_result.data.*.scans.McAfee.result"
                            },
                            {
                                "position": 19,
                                "type": "",
                                "value": "file_reputation:action_result.data.*.scans.McAfee-GW-Edition.detected"
                            },
                            {
                                "position": 20,
                                "type": "",
                                "value": "file_reputation:action_result.data.*.scans.McAfee-GW-Edition.result"
                            },
                            {
                                "position": 21,
                                "type": "",
                                "value": "file_reputation:action_result.data.*.scans.Microsoft.detected"
                            },
                            {
                                "position": 22,
                                "type": "",
                                "value": "file_reputation:action_result.data.*.scans.Microsoft.result"
                            },
                            {
                                "position": 23,
                                "type": "",
                                "value": "file_reputation:action_result.data.*.scans.Symantec.detected"
                            },
                            {
                                "position": 24,
                                "type": "",
                                "value": "file_reputation:action_result.data.*.scans.Symantec.result"
                            },
                            {
                                "position": 25,
                                "type": "",
                                "value": "file_reputation:action_result.data.*.scans.Sophos.detected"
                            },
                            {
                                "position": 26,
                                "type": "",
                                "value": "file_reputation:action_result.data.*.scans.Sophos.result"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 600,
                            "y": -80
                        },
                        "previous_function": "",
                        "previous_name": "reputation_format",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "format",
                        "status": "",
                        "template": "%%\n### VirusTotal Summary of {0}: *{1}, {2}*\n\n*VTI link: {3}*\n\nScan Date: {4}\n- sha1: {5}\n- sha256: {6}\n\n| Scanner | Detected | Result |\n| ---- | ---- | ---- |\n| CrowdStrike | {7} | {8} |\n| Cylance | {9} | {10} |\n| ESET | {11} | {12} |\n| FireEye | {13} | {14} |\n| MalwareBytes | {15} | {16} |\n| McAfee | {17} | {18} | \n| McAfee Gateway | {19} | {20} |\n| Microsoft | {21} | {22} |\n| Symantec | {23} | {24} | \n| Sophos | {25} | {26}\n\n---\n%%",
                        "title": "format",
                        "type": "coa.Format",
                        "warn": false,
                        "z": 690
                    },
                    {
                        ".scmName/text": "local",
                        "active": false,
                        "active_keys": {},
                        "active_values": {},
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".customFunction": {
                                "text": "merge list"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".scmName": {
                                "text": "local"
                            },
                            ".title": {
                                "text": "custom function"
                            },
                            ".title-info": {
                                "text": "Draft"
                            },
                            "g.branch image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def merge_list(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('merge_list() called')\n    \n    filtered_artifacts_data_0 = phantom.collect2(container=container, datapath=['filtered-data:fileHash_filter:condition_1:artifact:*.cef.fileHash'])\n\n    parameters = []\n\n    filtered_artifacts_data_0_0 = [item[0] for item in filtered_artifacts_data_0]\n\n    parameters.append({\n        'input_1': filtered_artifacts_data_0_0,\n        'input_2': None,\n        'input_3': None,\n        'input_4': None,\n        'input_5': None,\n        'input_6': None,\n        'input_7': None,\n        'input_8': None,\n        'input_9': None,\n        'input_10': None,\n    })\n    ################################################################################\n    ## Custom Code Start\n    ################################################################################\n\n    # Write your custom code here...\n\n    ################################################################################\n    ## Custom Code End\n    ################################################################################    \n\n    # call custom function \"local/drafts/list_merge_dedup_py3\", returns the custom_function_run_id\n    phantom.custom_function(custom_function='local/drafts/list_merge_dedup_py3', parameters=parameters, name='merge_list', callback=merge_list_callback)\n\n    return",
                        "callback_code": "def merge_list_callback(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None):\n    phantom.debug('merge_list_callback() called')\n    \n    file_reputation(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function)\n    hunt_hash(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function)\n\n    return",
                        "callback_start": 275,
                        "callsback": true,
                        "cfDisplayPath": "local/drafts/list_merge_dedup_py3",
                        "cfInputs": {
                            "input_1": {
                                "collectionType": "filtered_artifacts_data",
                                "dataPath": "filtered-data:fileHash_filter:condition_1:artifact:*.cef.fileHash",
                                "paramName": "filtered_artifacts_data_0_0",
                                "type": "list"
                            },
                            "input_10": {
                                "dataPath": "",
                                "type": "list"
                            },
                            "input_2": {
                                "dataPath": "",
                                "type": "list"
                            },
                            "input_3": {
                                "dataPath": "",
                                "type": "list"
                            },
                            "input_4": {
                                "dataPath": "",
                                "type": "list"
                            },
                            "input_5": {
                                "dataPath": "",
                                "type": "list"
                            },
                            "input_6": {
                                "dataPath": "",
                                "type": "list"
                            },
                            "input_7": {
                                "dataPath": "",
                                "type": "list"
                            },
                            "input_8": {
                                "dataPath": "",
                                "type": "list"
                            },
                            "input_9": {
                                "dataPath": "",
                                "type": "list"
                            }
                        },
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "currentVersion": true,
                        "customCodeEndLineOffset": 7,
                        "customCodeStartLine": 24,
                        "customFunction": "local/drafts/list_merge_dedup_py3",
                        "customFunctionId": null,
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "merge list",
                        "delay": 0,
                        "description": "You may need to remove some hashes for the applications you are trying to use.  Like Anomali only use MD5/SHA1 for example.",
                        "draftMode": true,
                        "existingCF": true,
                        "functionBlock": "custom function",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "652ffe24-4688-41be-8575-9774f968d7a0",
                        "inPorts": [
                            "in"
                        ],
                        "input_1-0": "filtered-data:fileHash_filter:condition_1:artifact:*.cef.fileHash",
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 283,
                        "line_start": 239,
                        "message": "Configuring now",
                        "name": "list_merge_dedup_py3",
                        "notes": "Merge and dedup url indicators into a single item list",
                        "number": 1,
                        "order": 9,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 100,
                            "y": -80
                        },
                        "previous_function": "",
                        "previous_name": "merge_list",
                        "selectedCustomFunction": {
                            "description": "Merge 2-10 different data paths into a single output data path. For example, if IP addresses are stored in the fields sourceAddress, destinationAddress, and deviceAddress, then those three fields could be merged together to form a single list of IP addresses.",
                            "draftMode": true,
                            "id": 51,
                            "inputs": [
                                {
                                    "_pretty_custom_function": "list_merge_dedup_py3",
                                    "contains_type": [
                                        "*"
                                    ],
                                    "custom_function": 51,
                                    "description": "",
                                    "id": 210,
                                    "input_type": "list",
                                    "name": "input_1",
                                    "placeholder": ""
                                },
                                {
                                    "_pretty_custom_function": "list_merge_dedup_py3",
                                    "contains_type": [
                                        "*"
                                    ],
                                    "custom_function": 51,
                                    "description": "",
                                    "id": 211,
                                    "input_type": "list",
                                    "name": "input_2",
                                    "placeholder": ""
                                },
                                {
                                    "_pretty_custom_function": "list_merge_dedup_py3",
                                    "contains_type": [
                                        "*"
                                    ],
                                    "custom_function": 51,
                                    "description": "",
                                    "id": 212,
                                    "input_type": "list",
                                    "name": "input_3",
                                    "placeholder": ""
                                },
                                {
                                    "_pretty_custom_function": "list_merge_dedup_py3",
                                    "contains_type": [
                                        "*"
                                    ],
                                    "custom_function": 51,
                                    "description": "",
                                    "id": 213,
                                    "input_type": "list",
                                    "name": "input_4",
                                    "placeholder": ""
                                },
                                {
                                    "_pretty_custom_function": "list_merge_dedup_py3",
                                    "contains_type": [
                                        "*"
                                    ],
                                    "custom_function": 51,
                                    "description": "",
                                    "id": 214,
                                    "input_type": "list",
                                    "name": "input_5",
                                    "placeholder": ""
                                },
                                {
                                    "_pretty_custom_function": "list_merge_dedup_py3",
                                    "contains_type": [
                                        "*"
                                    ],
                                    "custom_function": 51,
                                    "description": "",
                                    "id": 215,
                                    "input_type": "list",
                                    "name": "input_6",
                                    "placeholder": ""
                                },
                                {
                                    "_pretty_custom_function": "list_merge_dedup_py3",
                                    "contains_type": [
                                        "*"
                                    ],
                                    "custom_function": 51,
                                    "description": "",
                                    "id": 216,
                                    "input_type": "list",
                                    "name": "input_7",
                                    "placeholder": ""
                                },
                                {
                                    "_pretty_custom_function": "list_merge_dedup_py3",
                                    "contains_type": [
                                        "*"
                                    ],
                                    "custom_function": 51,
                                    "description": "",
                                    "id": 217,
                                    "input_type": "list",
                                    "name": "input_8",
                                    "placeholder": ""
                                },
                                {
                                    "_pretty_custom_function": "list_merge_dedup_py3",
                                    "contains_type": [
                                        "*"
                                    ],
                                    "custom_function": 51,
                                    "description": "",
                                    "id": 218,
                                    "input_type": "list",
                                    "name": "input_9",
                                    "placeholder": ""
                                },
                                {
                                    "_pretty_custom_function": "list_merge_dedup_py3",
                                    "contains_type": [
                                        "*"
                                    ],
                                    "custom_function": 51,
                                    "description": "",
                                    "id": 219,
                                    "input_type": "list",
                                    "name": "input_10",
                                    "placeholder": ""
                                }
                            ],
                            "name": "list_merge_dedup_py3",
                            "outputs": [
                                {
                                    "_pretty_custom_function": "list_merge_dedup_py3",
                                    "contains_type": [
                                        "*"
                                    ],
                                    "custom_function": 51,
                                    "data_path": "*.item",
                                    "description": "A combined list of all the values from all the input lists",
                                    "id": 147
                                }
                            ],
                            "playbooks": {
                                "draft_playbooks": [],
                                "draft_version_id": null,
                                "playbooks": [
                                    {
                                        "active": false,
                                        "display_path": "local/Indicator Analysis - Domain_py3",
                                        "draft_mode": true,
                                        "id": 171,
                                        "is_modern": false,
                                        "name": "Indicator Analysis - Domain_py3",
                                        "playbook_type": "automation",
                                        "viewable": true
                                    }
                                ]
                            },
                            "scmId": 2,
                            "scmName": "local"
                        },
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "repo",
                        "status": "",
                        "title": "custom function",
                        "type": "coa.CustomFunctionBlock",
                        "userGeneratedCode": "    # Write your custom code here...\n",
                        "warn": false,
                        "z": 691
                    }
                ]
            },
            "notes": "INPUT: Filehash artifact\nINTERACTION: VirusTotal, RecordedFuture, Hybrid Analysis\nACTION: filehash reputation, filehash intelligence, hunt hash\nARTIFACTS:\nP1: get intel and reputation, create a new task and add a note with the summarized intel\nP2: if a total failure report errors"
        },
        "input_spec": null,
        "output_spec": null,
        "playbook_type": "automation",
        "python_version": "3",
        "schema": "4",
        "version": "6.1.0.131"
    },
    "create_time": "2023-07-28T08:17:04.275185+00:00",
    "draft_mode": false,
    "labels": [
        "*"
    ],
    "tags": []
}